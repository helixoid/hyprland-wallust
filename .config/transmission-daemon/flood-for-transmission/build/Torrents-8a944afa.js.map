{"version":3,"file":"Torrents-8a944afa.js","sources":["../../src/components/Modal/Settings/Torrents.svelte"],"sourcesContent":["<script>\n  import Header from './Header.svelte';\n  import Icon from '~components/Icon';\n  import Input from '~components/Input';\n  import InputPath from '~components/InputPath';\n  import Checkbox from '~components/Checkbox';\n  import Button from '~components/Button';\n  import { session, modals, alerts } from '~helpers/stores';\n  import {\n    SESSION_COLUMN_DOWNLOAD_DIR,\n    SESSION_COLUMN_START_ADDED,\n    SESSION_COLUMN_RENAME_PARTIAL_FILES,\n    SESSION_COLUMN_IDLE_SEEDING_LIMIT_ENABLED,\n    SESSION_COLUMN_IDLE_SEEDING_LIMIT,\n    SESSION_COLUMN_SEED_RATIO_LIMITED,\n    SESSION_COLUMN_SEED_RATIO_LIMIT,\n    SESSION_COLUMN_DOWNLOAD_QUEUE_SIZE,\n    SESSION_COLUMN_DOWNLOAD_QUEUE_ENABLED,\n    SESSION_COLUMN_SEED_QUEUE_SIZE,\n    SESSION_COLUMN_SEED_QUEUE_ENABLED,\n    SESSION_COLUMN_INCOMPLETE_DIR,\n    SESSION_COLUMN_INCOMPLETE_DIR_ENABLED,\n    SESSION_COLUMN_QUEUE_STALLED_MINUTES,\n    SESSION_COLUMN_QUEUE_STALLED_ENABLED,\n    SESSION_COLUMN_REMOVE_ADDED,\n    SESSION_COLUMN_SCRIPT_DONE_ENABLED,\n    SESSION_COLUMN_SCRIPT_DONE,\n  } from '~helpers/constants/columns';\n\n  let loadingInitial = true;\n  let loadingSubmit = false;\n  let downloadDir = null;\n  let startAddedTorrents = null;\n  let renamePartialFiles = null;\n  let seedRatioLimited = null;\n  let seedRatioLimit = null;\n  let idleSeedingLimited = null;\n  let idleSeedingLimit = null;\n  let downloadQueueSize = null;\n  let downloadQueueEnabled = null;\n  let seedQueueSize = null;\n  let seedQueueEnabled = null;\n  let incompleteDir = null;\n  let incompleteDirEnabled = null;\n  let queueStalledEnabled = null;\n  let queueStalledMinutes = null;\n  let removeTorrentFile = null;\n  let scriptDoneEnabled = null;\n  let scriptDone = null;\n\n  session\n    .addColumns([\n      SESSION_COLUMN_DOWNLOAD_DIR,\n      SESSION_COLUMN_START_ADDED,\n      SESSION_COLUMN_RENAME_PARTIAL_FILES,\n      SESSION_COLUMN_SEED_RATIO_LIMITED,\n      SESSION_COLUMN_SEED_RATIO_LIMIT,\n      SESSION_COLUMN_IDLE_SEEDING_LIMIT_ENABLED,\n      SESSION_COLUMN_IDLE_SEEDING_LIMIT,\n      SESSION_COLUMN_DOWNLOAD_QUEUE_SIZE,\n      SESSION_COLUMN_DOWNLOAD_QUEUE_ENABLED,\n      SESSION_COLUMN_SEED_QUEUE_SIZE,\n      SESSION_COLUMN_SEED_QUEUE_ENABLED,\n      SESSION_COLUMN_INCOMPLETE_DIR,\n      SESSION_COLUMN_INCOMPLETE_DIR_ENABLED,\n      SESSION_COLUMN_QUEUE_STALLED_MINUTES,\n      SESSION_COLUMN_QUEUE_STALLED_ENABLED,\n      SESSION_COLUMN_REMOVE_ADDED,\n      SESSION_COLUMN_SCRIPT_DONE_ENABLED,\n      SESSION_COLUMN_SCRIPT_DONE,\n    ])\n    .then(($session) => {\n      downloadDir = $session[SESSION_COLUMN_DOWNLOAD_DIR];\n      startAddedTorrents = $session[SESSION_COLUMN_START_ADDED];\n      renamePartialFiles = $session[SESSION_COLUMN_RENAME_PARTIAL_FILES];\n      seedRatioLimited = $session[SESSION_COLUMN_SEED_RATIO_LIMITED];\n      seedRatioLimit = $session[SESSION_COLUMN_SEED_RATIO_LIMIT];\n      idleSeedingLimited = $session[SESSION_COLUMN_IDLE_SEEDING_LIMIT_ENABLED];\n      idleSeedingLimit = $session[SESSION_COLUMN_IDLE_SEEDING_LIMIT];\n      downloadQueueSize = $session[SESSION_COLUMN_DOWNLOAD_QUEUE_SIZE];\n      downloadQueueEnabled = $session[SESSION_COLUMN_DOWNLOAD_QUEUE_ENABLED];\n      seedQueueSize = $session[SESSION_COLUMN_SEED_QUEUE_SIZE];\n      seedQueueEnabled = $session[SESSION_COLUMN_SEED_QUEUE_ENABLED];\n      incompleteDir = $session[SESSION_COLUMN_INCOMPLETE_DIR];\n      incompleteDirEnabled = $session[SESSION_COLUMN_INCOMPLETE_DIR_ENABLED];\n      queueStalledMinutes = $session[SESSION_COLUMN_QUEUE_STALLED_MINUTES];\n      queueStalledEnabled = $session[SESSION_COLUMN_QUEUE_STALLED_ENABLED];\n      removeTorrentFile = $session[SESSION_COLUMN_REMOVE_ADDED];\n      scriptDoneEnabled = $session[SESSION_COLUMN_SCRIPT_DONE_ENABLED];\n      scriptDone = $session[SESSION_COLUMN_SCRIPT_DONE];\n      loadingInitial = false;\n    })\n    .catch(() => {\n      alerts.add(\n        'Unable to fetch the data for that action right now. Try again later.',\n        'negative'\n      );\n    });\n\n  const handleSubmit = () => {\n    loadingSubmit = true;\n\n    session\n      .update({\n        [SESSION_COLUMN_DOWNLOAD_DIR]: downloadDir,\n        [SESSION_COLUMN_START_ADDED]: startAddedTorrents,\n        [SESSION_COLUMN_RENAME_PARTIAL_FILES]: renamePartialFiles,\n        [SESSION_COLUMN_SEED_RATIO_LIMITED]: seedRatioLimited,\n        [SESSION_COLUMN_SEED_RATIO_LIMIT]: seedRatioLimit,\n        [SESSION_COLUMN_IDLE_SEEDING_LIMIT_ENABLED]: idleSeedingLimited,\n        [SESSION_COLUMN_IDLE_SEEDING_LIMIT]: idleSeedingLimit,\n        [SESSION_COLUMN_DOWNLOAD_QUEUE_SIZE]: downloadQueueSize,\n        [SESSION_COLUMN_DOWNLOAD_QUEUE_ENABLED]: downloadQueueEnabled,\n        [SESSION_COLUMN_SEED_QUEUE_SIZE]: seedQueueSize,\n        [SESSION_COLUMN_SEED_QUEUE_ENABLED]: seedQueueEnabled,\n        [SESSION_COLUMN_INCOMPLETE_DIR]: incompleteDir,\n        [SESSION_COLUMN_INCOMPLETE_DIR_ENABLED]: incompleteDirEnabled,\n        [SESSION_COLUMN_QUEUE_STALLED_MINUTES]: queueStalledMinutes,\n        [SESSION_COLUMN_QUEUE_STALLED_ENABLED]: queueStalledEnabled,\n        [SESSION_COLUMN_REMOVE_ADDED]: removeTorrentFile,\n        [SESSION_COLUMN_SCRIPT_DONE_ENABLED]: scriptDoneEnabled,\n        [SESSION_COLUMN_SCRIPT_DONE]: scriptDone,\n      })\n      .then(() => {\n        alerts.add('Succesfully saved torrent settings');\n      })\n      .catch(() => {\n        alerts.add(\n          'Failed saving torrent settings, please try again',\n          'negative'\n        );\n      })\n      .finally(() => {\n        loadingSubmit = false;\n      });\n  };\n</script>\n\n<div class=\"wrapper\" class:loading-initial=\"{loadingInitial}\">\n  <Icon name=\"SpinnerIcon\" />\n  <form on:submit|preventDefault=\"{handleSubmit}\">\n    <Header text=\"Downloading\" />\n    <InputPath\n      label=\"Download to\"\n      bind:value=\"{downloadDir}\"\n      hint=\"This will be used as the default location for Transmission when adding a new torrent.\"\n    />\n    <Checkbox label=\"Start when added\" bind:checked=\"{startAddedTorrents}\" />\n    <Checkbox\n      label=\"Remove torrent file when added\"\n      bind:checked=\"{removeTorrentFile}\"\n    />\n    <Checkbox\n      label=\"{'Append \".part\" to incomplete files\\' names'}\"\n      bind:checked=\"{renamePartialFiles}\"\n    />\n    <Checkbox\n      label=\"Incomplete directory:\"\n      bind:checked=\"{incompleteDirEnabled}\"\n    />\n    <InputPath\n      bind:value=\"{incompleteDir}\"\n      hint=\"Will default to the download directory when not enabled\"\n    />\n    <Checkbox\n      label=\"Run script when complete:\"\n      bind:checked=\"{scriptDoneEnabled}\"\n    />\n    <InputPath bind:value=\"{scriptDone}\" />\n\n    <Header text=\"Seeding\" />\n    <Checkbox\n      label=\"Stop seeding at ratio:\"\n      bind:checked=\"{seedRatioLimited}\"\n    />\n    <Input bind:value=\"{seedRatioLimit}\" type=\"number\" step=\"0.000001\" />\n    <Checkbox\n      label=\"Stop seeding if idle for (min):\"\n      bind:checked=\"{idleSeedingLimited}\"\n    />\n    <Input bind:value=\"{idleSeedingLimit}\" type=\"number\" />\n\n    <Header text=\"Queue\" />\n    <Checkbox\n      label=\"Limit concurrent downloads:\"\n      bind:checked=\"{downloadQueueEnabled}\"\n    />\n    <Input bind:value=\"{downloadQueueSize}\" type=\"number\" />\n    <Checkbox\n      label=\"Limit concurrent seeding:\"\n      bind:checked=\"{seedQueueEnabled}\"\n    />\n    <Input bind:value=\"{seedQueueSize}\" type=\"number\" />\n    <Checkbox\n      label=\"Consider inactive after (minutes):\"\n      bind:checked=\"{queueStalledEnabled}\"\n    />\n    <Input\n      bind:value=\"{queueStalledMinutes}\"\n      type=\"number\"\n      hint=\"Torrents that are inactive for this amount of minutes will not be considered as a concurrent download/seed.\"\n    />\n\n    <div class=\"buttons\">\n      <Button type=\"button\" priority=\"tertiary\" on:click=\"{modals.close}\">\n        Cancel\n      </Button>\n      <Button type=\"submit\" priority=\"primary\" loading=\"{loadingSubmit}\">\n        Save settings\n      </Button>\n    </div>\n  </form>\n</div>\n\n<style>\n  .wrapper {\n    min-height: 100%;\n    display: flex;\n  }\n\n  .wrapper.loading-initial {\n    align-items: center;\n    justify-content: center;\n    fill: var(--color-modal-loading);\n  }\n\n  .wrapper > :global(.icon) {\n    position: absolute;\n    height: 30px;\n    width: 30px;\n    display: none;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n\n  .wrapper.loading-initial > :global(.icon) {\n    display: inherit;\n  }\n\n  .wrapper.loading-initial form {\n    visibility: hidden;\n  }\n\n  form {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n    color: var(--color-modal-text);\n  }\n\n  form :global(.checkbox) {\n    margin-bottom: 15px;\n  }\n\n  .buttons {\n    flex-grow: 1;\n    align-items: flex-end;\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n  }\n</style>\n"],"names":["ctx","button0","$on","modals","close","insert","target","div1","anchor","append","form","div0","loadingInitial","loadingSubmit","downloadDir","startAddedTorrents","renamePartialFiles","seedRatioLimited","seedRatioLimit","idleSeedingLimited","idleSeedingLimit","downloadQueueSize","downloadQueueEnabled","seedQueueSize","seedQueueEnabled","incompleteDir","incompleteDirEnabled","queueStalledEnabled","queueStalledMinutes","removeTorrentFile","scriptDoneEnabled","scriptDone","session","addColumns","SESSION_COLUMN_DOWNLOAD_DIR","SESSION_COLUMN_START_ADDED","SESSION_COLUMN_RENAME_PARTIAL_FILES","SESSION_COLUMN_SEED_RATIO_LIMITED","SESSION_COLUMN_SEED_RATIO_LIMIT","SESSION_COLUMN_IDLE_SEEDING_LIMIT_ENABLED","SESSION_COLUMN_IDLE_SEEDING_LIMIT","SESSION_COLUMN_DOWNLOAD_QUEUE_SIZE","SESSION_COLUMN_DOWNLOAD_QUEUE_ENABLED","SESSION_COLUMN_SEED_QUEUE_SIZE","SESSION_COLUMN_SEED_QUEUE_ENABLED","SESSION_COLUMN_INCOMPLETE_DIR","SESSION_COLUMN_INCOMPLETE_DIR_ENABLED","SESSION_COLUMN_QUEUE_STALLED_MINUTES","SESSION_COLUMN_QUEUE_STALLED_ENABLED","SESSION_COLUMN_REMOVE_ADDED","SESSION_COLUMN_SCRIPT_DONE_ENABLED","SESSION_COLUMN_SCRIPT_DONE","then","$session","$$invalidate","catch","alerts","add","handleSubmit","update","finally","value"],"mappings":"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"}