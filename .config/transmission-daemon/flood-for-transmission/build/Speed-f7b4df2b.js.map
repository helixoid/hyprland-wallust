{"version":3,"file":"Speed-f7b4df2b.js","sources":["../../src/components/Modal/Settings/Speed.svelte"],"sourcesContent":["<script>\n  import Header from './Header.svelte';\n  import Checkbox from '~components/Checkbox';\n  import Input from '~components/Input';\n  import Button from '~components/Button';\n  import Icon from '~components/Icon';\n  import { session, modals, alerts } from '~helpers/stores';\n  import { minutesToTime, timeToMinutes } from '~helpers/timeHelper';\n  import {\n    SESSION_COLUMN_SPEED_LIMIT_UP_ENABLED,\n    SESSION_COLUMN_SPEED_LIMIT_UP,\n    SESSION_COLUMN_SPEED_LIMIT_DOWN_ENABLED,\n    SESSION_COLUMN_SPEED_LIMIT_DOWN,\n    SESSION_COLUMN_ALT_SPEED_ENABLED,\n    SESSION_COLUMN_ALT_SPEED_UP,\n    SESSION_COLUMN_ALT_SPEED_DOWN,\n    SESSION_COLUMN_ALT_SPEED_TIME_ENABLED,\n    SESSION_COLUMN_ALT_SPEED_TIME_BEGIN,\n    SESSION_COLUMN_ALT_SPEED_TIME_END,\n  } from '~helpers/constants/columns';\n\n  let loadingInitial = true;\n  let loadingSubmit = false;\n\n  let uploadLimitEnabled = null;\n  let uploadLimit = null;\n  let downloadLimitEnabled = null;\n  let downloadLimit = null;\n  let altLimitsEnabled = null;\n  let altUploadLimit = null;\n  let altDownloadLimit = null;\n  let altSpeedTimeEnabled = null;\n  let altSpeedTimeBegin = null;\n  let altSpeedTimeEnd = null;\n\n  session\n    .addColumns([\n      SESSION_COLUMN_SPEED_LIMIT_UP_ENABLED,\n      SESSION_COLUMN_SPEED_LIMIT_UP,\n      SESSION_COLUMN_SPEED_LIMIT_DOWN_ENABLED,\n      SESSION_COLUMN_SPEED_LIMIT_DOWN,\n      SESSION_COLUMN_ALT_SPEED_ENABLED,\n      SESSION_COLUMN_ALT_SPEED_UP,\n      SESSION_COLUMN_ALT_SPEED_DOWN,\n      SESSION_COLUMN_ALT_SPEED_TIME_ENABLED,\n      SESSION_COLUMN_ALT_SPEED_TIME_BEGIN,\n      SESSION_COLUMN_ALT_SPEED_TIME_END,\n    ])\n    .then(($session) => {\n      uploadLimitEnabled = $session[SESSION_COLUMN_SPEED_LIMIT_UP_ENABLED];\n      uploadLimit = $session[SESSION_COLUMN_SPEED_LIMIT_UP];\n      downloadLimitEnabled = $session[SESSION_COLUMN_SPEED_LIMIT_DOWN_ENABLED];\n      downloadLimit = $session[SESSION_COLUMN_SPEED_LIMIT_DOWN];\n      altLimitsEnabled = $session[SESSION_COLUMN_ALT_SPEED_ENABLED];\n      altUploadLimit = $session[SESSION_COLUMN_ALT_SPEED_UP];\n      altDownloadLimit = $session[SESSION_COLUMN_ALT_SPEED_DOWN];\n      altSpeedTimeEnabled = $session[SESSION_COLUMN_ALT_SPEED_TIME_ENABLED];\n      altSpeedTimeBegin = minutesToTime(\n        $session[SESSION_COLUMN_ALT_SPEED_TIME_BEGIN]\n      );\n      altSpeedTimeEnd = minutesToTime(\n        $session[SESSION_COLUMN_ALT_SPEED_TIME_END]\n      );\n\n      loadingInitial = false;\n    })\n    .catch(() => {\n      alerts.add(\n        'Unable to fetch the data for that action right now. Try again later.',\n        'negative'\n      );\n    });\n\n  const handleSubmit = () => {\n    loadingSubmit = true;\n\n    session\n      .update({\n        'speed-limit-up-enabled': uploadLimitEnabled,\n        'speed-limit-up': uploadLimit,\n        'speed-limit-down-enabled': downloadLimitEnabled,\n        'speed-limit-down': downloadLimit,\n        'alt-speed-enabled': altLimitsEnabled,\n        'alt-speed-up': altUploadLimit,\n        'alt-speed-down': altDownloadLimit,\n        'alt-speed-time-enabled': altSpeedTimeEnabled,\n        'alt-speed-time-begin': timeToMinutes(altSpeedTimeBegin),\n        'alt-speed-time-end': timeToMinutes(altSpeedTimeEnd),\n      })\n      .then(() => {\n        alerts.add('Succesfully saved speed settings');\n      })\n      .catch(() => {\n        alerts.add(\n          'Failed saving speed settings, please try again',\n          'negative'\n        );\n      })\n      .finally(() => {\n        loadingSubmit = false;\n      });\n  };\n</script>\n\n<div class=\"wrapper\" class:loading-initial=\"{loadingInitial}\">\n  <Icon name=\"SpinnerIcon\" />\n  <form on:submit|preventDefault=\"{handleSubmit}\">\n    <Header text=\"Speed Limits\" />\n    <Checkbox bind:checked=\"{uploadLimitEnabled}\" label=\"Upload (kB/s)\" />\n    <Input bind:value=\"{uploadLimit}\" type=\"number\" />\n\n    <Checkbox bind:checked=\"{downloadLimitEnabled}\" label=\"Download (kB/s)\" />\n    <Input bind:value=\"{downloadLimit}\" type=\"number\" />\n\n    <Header text=\"Alternative Speed Limits\" />\n    <Checkbox\n      bind:checked=\"{altLimitsEnabled}\"\n      label=\"Alternative speeds enabled\"\n    />\n\n    <Input bind:value=\"{altUploadLimit}\" label=\"Upload (kB/s)\" type=\"number\" />\n\n    <Input\n      bind:value=\"{altDownloadLimit}\"\n      label=\"Download (kB/s)\"\n      type=\"number\"\n    />\n\n    <Checkbox bind:checked=\"{altSpeedTimeEnabled}\" label=\"Scheduled Times\" />\n\n    <Input bind:value=\"{altSpeedTimeBegin}\" label=\"From\" type=\"time\" />\n    <Input bind:value=\"{altSpeedTimeEnd}\" label=\"To\" type=\"time\" />\n\n    <div class=\"buttons\">\n      <Button type=\"button\" priority=\"tertiary\" on:click=\"{modals.close}\">\n        Cancel\n      </Button>\n      <Button type=\"submit\" priority=\"primary\" loading=\"{loadingSubmit}\">\n        Save settings\n      </Button>\n    </div>\n  </form>\n</div>\n\n<style>\n  .wrapper {\n    min-height: 100%;\n    display: flex;\n  }\n\n  .wrapper.loading-initial {\n    align-items: center;\n    justify-content: center;\n    fill: var(--color-modal-loading);\n  }\n\n  .wrapper > :global(.icon) {\n    position: absolute;\n    height: 30px;\n    width: 30px;\n    display: none;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n\n  .wrapper.loading-initial > :global(.icon) {\n    display: inherit;\n  }\n\n  .wrapper.loading-initial form {\n    visibility: hidden;\n  }\n\n  form {\n    width: 100%;\n    display: flex;\n    flex-direction: column;\n    line-height: 1;\n    color: var(--color-modal-text);\n  }\n\n  form :global(.checkbox) {\n    margin-bottom: 15px;\n  }\n\n  .buttons {\n    flex-grow: 1;\n    align-items: flex-end;\n    display: flex;\n    justify-content: flex-end;\n    gap: 10px;\n  }\n</style>\n"],"names":["ctx","button0","$on","modals","close","insert","target","div1","anchor","append","form","div0","loadingInitial","loadingSubmit","uploadLimitEnabled","uploadLimit","downloadLimitEnabled","downloadLimit","altLimitsEnabled","altUploadLimit","altDownloadLimit","altSpeedTimeEnabled","altSpeedTimeBegin","altSpeedTimeEnd","session","addColumns","SESSION_COLUMN_SPEED_LIMIT_UP_ENABLED","SESSION_COLUMN_SPEED_LIMIT_UP","SESSION_COLUMN_SPEED_LIMIT_DOWN_ENABLED","SESSION_COLUMN_SPEED_LIMIT_DOWN","SESSION_COLUMN_ALT_SPEED_ENABLED","SESSION_COLUMN_ALT_SPEED_UP","SESSION_COLUMN_ALT_SPEED_DOWN","SESSION_COLUMN_ALT_SPEED_TIME_ENABLED","SESSION_COLUMN_ALT_SPEED_TIME_BEGIN","SESSION_COLUMN_ALT_SPEED_TIME_END","then","$session","$$invalidate","minutesToTime","catch","alerts","add","handleSubmit","update","timeToMinutes","finally","value"],"mappings":"gYAsI0E,8EAGD,gVA7B1B,IAAlBA,EAAkB,gBAAlBA,EAAkB,4GACZ,IAAXA,EAAW,cAAXA,EAAW,oHAEc,IAApBA,EAAoB,gBAApBA,EAAoB,4GACZ,IAAbA,EAAa,cAAbA,EAAa,kLAIA,IAAhBA,EAAgB,gBAAhBA,EAAgB,kIAIC,IAAdA,EAAc,cAAdA,EAAc,kIAGH,IAAhBA,EAAgB,cAAhBA,EAAgB,oHAKa,IAAnBA,EAAmB,gBAAnBA,EAAmB,yHAEP,IAAjBA,EAAiB,eAAjBA,EAAiB,qGACF,IAAfA,EAAe,eAAfA,EAAe,qJAGoBC,GAAAC,IAAA,QAAAC,EAAOC,iEAGTJ,EAAa,+iBAjCzBA,EAAc,YAA3DK,EAsCMC,EAAAC,EAAAC,sBApCJC,EAmCOF,EAAAG,8OARLD,EAOMC,EAAAC,sEAlCyBX,EAAY,2DAElBA,EAAkB,8DACvBA,EAAW,iEAENA,EAAoB,+DACzBA,EAAa,iEAIhBA,EAAgB,gEAIbA,EAAc,gEAGnBA,EAAgB,oEAKNA,EAAmB,qEAExBA,EAAiB,sEACjBA,EAAe,uHAMkBA,EAAa,wFAjCzBA,EAAc,muBAnFrD,IAAAY,GAAiB,EACjBC,GAAgB,EAEhBC,EAAqB,KACrBC,EAAc,KACdC,EAAuB,KACvBC,EAAgB,KAChBC,EAAmB,KACnBC,EAAiB,KACjBC,EAAmB,KACnBC,EAAsB,KACtBC,EAAoB,KACpBC,EAAkB,KAEtBC,EACGC,WAAU,CACTC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,IAEDC,MAAMC,QACLvB,EAAqBuB,EAASX,QAC9BX,EAAcsB,EAASV,QACvBX,EAAuBqB,EAAST,QAChCX,EAAgBoB,EAASR,QACzBX,EAAmBmB,EAASP,QAC5BX,EAAiBkB,EAASN,QAC1BX,EAAmBiB,EAASL,QAC5BX,EAAsBgB,EAASJ,IAC/BK,EAAA,GAAAhB,EAAoBiB,EAClBF,EAASH,KAEXI,EAAA,GAAAf,EAAkBgB,EAChBF,EAASF,KAGXG,EAAA,EAAA1B,GAAiB,EAAK,IAEvB4B,OAAK,KACJC,EAAOC,IACL,uEACA,WAAU,mCAIEC,KAChBL,EAAA,EAAAzB,GAAgB,GAEhBW,EACGoB,OAAM,CACL,yBAA0B9B,EAC1B,iBAAkBC,EAClB,2BAA4BC,EAC5B,mBAAoBC,EACpB,oBAAqBC,EACrB,eAAgBC,EAChB,iBAAkBC,EAClB,yBAA0BC,EAC1B,uBAAwBwB,EAAcvB,GACtC,qBAAsBuB,EAActB,KAErCa,MAAI,KACHK,EAAOC,IAAI,mCAAkC,IAE9CF,OAAK,KACJC,EAAOC,IACL,iDACA,WAAU,IAGbI,SAAO,KACNR,EAAA,EAAAzB,GAAgB,EAAK,iBASAC,EAAkBiC,sBACvBhC,EAAWgC,sBAEN/B,EAAoB+B,sBACzB9B,EAAa8B,sBAIhB7B,EAAgB6B,sBAIb5B,EAAc4B,sBAGnB3B,EAAgB2B,sBAKN1B,EAAmB0B,sBAExBzB,EAAiByB,uBACjBxB,EAAewB"}